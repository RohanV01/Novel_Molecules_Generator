# SMILES Generator Using Fine-Tuned GPT-2 Model

Welcome to the **SMILES Generator**, a sophisticated tool built using a GPT-2 model with 137 million parameters, meticulously fine-tuned on a dataset of 100,000 molecular structures. This application is designed to generate novel molecular structures based on the Simplified Molecular Input Line Entry System (SMILES) format.

## Table of Contents

- [Key Features](#key-features)
- [How It Works](#how-it-works)
- [Installation](#installation)
  - [Prerequisites](#prerequisites)
  - [Dependencies](#dependencies)
  - [Model Files](#model-files)
- [Usage](#usage)
  - [Running the Application](#running-the-application)
  - [Application Interface](#application-interface)
  - [Example Usage](#example-usage)
- [Code Overview](#code-overview)
  - [Functions](#functions)
  - [Application Structure](#application-structure)
- [Notes](#notes)
- [Contributing](#contributing)
- [License](#license)
- [Contact](#contact)

## Key Features

- **Novel Molecule Generation**: Leverages a fine-tuned GPT-2 model to create novel and unique molecular structures that are not found in the training dataset.
- **Validity Checks**: Utilizes RDKit, a powerful cheminformatics software, to ensure that each generated molecule is valid according to standard chemical rules.
- **Drug-Like Molecule Focus**: Specifically generates molecules with drug-like properties, making this tool particularly valuable for researchers and professionals in drug discovery and pharmaceutical sciences.

## How It Works

1. **Input Fragment**: Users can input a starting fragment of a SMILES string to guide the generation process.
2. **Customization**: Adjust the number of molecules to generate and the maximum length of the SMILES strings to tailor the output to your needs.
3. **Generation and Validation**: The model generates SMILES strings, which are then validated and filtered by RDKit to ensure that they represent viable, drug-like molecules.

## Installation

### Prerequisites

- **Python**: Version 3.7 or higher.
- **pip**: Python package manager.
- **Conda**: Recommended for RDKit installation.

### Dependencies

Install the required Python packages using the following commands:

```bash
pip install streamlit pandas transformers
```

**RDKit Installation:**

RDKit is a specialized package and is best installed via conda:

```bash
conda install -c rdkit rdkit
```

If you don't have conda installed, download it from [Miniconda](https://docs.conda.io/en/latest/miniconda.html) or [Anaconda](https://www.anaconda.com/products/individual).

### Model Files

Ensure that you have the fine-tuned GPT-2 model accessible. The code expects the model to be located at:

```
/mnt/c/Users/user/DD_Pipeline/model_training/smiles_gpt2/checkpoint-17496
```

If your model is in a different location, update the `load_model()` function in the code accordingly:

```python
def load_model():
    model = AutoModelForCausalLM.from_pretrained("path/to/your/model")
    return model
```

## Usage

### Running the Application

Save the provided code in a file, e.g., `app.py`. Then run the Streamlit application using:

```bash
streamlit run Molecules_Generator.py
```

### Application Interface

- **Title and Description**: Provides information about the application and its features.
- **Sidebar Settings**:
  - **Input Fragment**: Enter a starting fragment of a SMILES string.
  - **Number of SMILES to Generate**: Set how many molecules you want to generate.
  - **Maximum Length of SMILES String**: Set the maximum allowed length for the SMILES strings.
- **Generate Button**: Starts the SMILES generation process.
- **Results Display**:
  - **Valid Generated SMILES**: Displays a table of valid SMILES strings generated by the model.
  - **Download Option**: Allows you to download the generated SMILES strings as a CSV file.

### Example Usage

1. **Start the Application**: Run `streamlit run app.py` and open the app in your web browser.
2. **Input Fragment**: In the sidebar, enter `CCO` as the starting fragment.
3. **Adjust Parameters**:
   - Set **Number of SMILES to generate** to `5`.
   - Set **Maximum length of SMILES string** to `100`.
4. **Generate SMILES**: Click on the **Generate SMILES** button.
5. **View Results**: The valid generated SMILES strings will be displayed in a table.
6. **Download Results**: Click on **Download Generated SMILES as CSV** to save the results.

## Code Overview

### Functions

- **`load_model()`**: Loads the fine-tuned GPT-2 model. Uses `@st.cache_data` to cache the model for faster loading.
- **`load_tokenizer()`**: Loads the GPT-2 tokenizer and sets the padding token. Cached for performance.
- **`generate_smiles(prompt, max_length, num_return_sequences)`**: Generates SMILES strings based on the input prompt.
- **`is_valid_smiles(smiles)`**: Checks if a SMILES string is valid using RDKit.
- **`convert_df_to_csv(df)`**: Converts a Pandas DataFrame to CSV format for downloading.

### Application Structure

- **Imports**: Necessary libraries are imported at the beginning.
- **Model and Tokenizer Loading**: The model and tokenizer are loaded and cached.
- **SMILES Generation Functions**: Functions to generate and validate SMILES strings.
- **Streamlit UI**: The user interface is defined using Streamlit components.
- **Main Logic**: When the **Generate SMILES** button is clicked, the app generates SMILES strings and displays valid ones.

## Notes

- **Model Path**: Make sure to update the model path in the `load_model()` function if your model is stored elsewhere.
- **RDKit Validity**: Only SMILES strings that RDKit can parse are considered valid.
- **Caching**: The `@st.cache_data` decorator is used to improve performance by caching data across runs.
- **Error Handling**: If no valid SMILES are generated, an error message will prompt you to adjust the parameters.

## Contributing

Contributions are welcome! Please follow these steps:

1. Fork the repository.
2. Create a new branch: `git checkout -b feature/your-feature-name`.
3. Commit your changes: `git commit -am 'Add some feature'`.
4. Push to the branch: `git push origin feature/your-feature-name`.
5. Submit a pull request.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

## Contact

For questions or suggestions, please contact:

- **Name**: Rohan Vyas
- **Email**: rohanvyas661@gmail.com

---

We hope this tool aids in your research and development efforts. Happy molecule generation!